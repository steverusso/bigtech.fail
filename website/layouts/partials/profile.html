<!--
	This partial returns the URL for the profile picture of the given Profile,
	using the specified image param first, then the PNG if it exists, and finally
	defaulting to the JPG.
-->
{{ define "partials/profile/pic" }}
	{{ $pic := "" }}

	{{ with .Param "image" }}
		{{ $pic = . }}
	{{ else }}
		{{ $key := anchorize .Title }}
		{{ range $ext := slice "jpg" "png" }}
			{{ $imgSrc := printf "/img/people/%s.%s" $key $ext }}
			{{ $exists := printf "/static%s" $imgSrc | fileExists }}

			{{ $pic = $pic | cond $exists $imgSrc }}
		{{ end }}
	{{ end }}

	{{ return $pic }}
{{ end }}

<!--
	A Profile's independent / alt tech links. Range over the link meta data, not
	the links themselves, so that:
	 1) the order is consistent, every time, no matter what links a profile provides.
	 2) to change the order, or remove a link, a change is only needed in one place.
-->
{{ define "partials/profile/links" }}
	<div>
		{{ range $v := site.Data.profileLinksMeta }}
			<!-- Proceed if the profile provides this link. -->
			{{ with index $ .key }}
				{{ $prefix := $v.prefix | default "" }}
				{{ $suffix := $v.suffix | default "" }}
				{{ $href := printf "https://%s/%s%s" $prefix . $suffix }}

				<a href="{{ $href }}" title="{{ $v.text }}" target="_blank">
					{{ $type := cond (isset $v "icon") "icons" "logos" }}
					<img src="/img/{{ $type }}/{{ $v.key }}.png" width="32" height="32" loading="lazy">
				</a>
			{{ end }}
		{{ end }}
	</div>
{{ end }}
